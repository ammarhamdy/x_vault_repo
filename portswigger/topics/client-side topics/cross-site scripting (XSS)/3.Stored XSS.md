
https://portswigger.net/web-security/cross-site-scripting/stored
---
# What is stored cross-site scripting?

Suppose a website allows users to submit comments on blog posts, which are displayed to other users. 

Users submit comments using an HTTP request like the following:
```http
POST /post/comment HTTP/1.1
Host: vulnerable-website.com
Content-Length: 100

postId=3&comment=This+post+was+extremely+helpful.&name=Carlos+Montoya&email=carlos%40normal-user.net
```
After this comment has been submitted, any user who visits the blog post will receive the following within the application's response:
```html
<p>This post was extremely helpful.</p>
```
Assuming the application doesn't perform any other processing of the data, an attacker can submit a malicious comment like this:
```html
<script>/* Bad stuff here... */</script>
```


# How to find and test for stored XSS vulnerabilities
Entry points into the application's processing include:
- Parameters or other data within the URL query string and message body.
- The URL file path.
- HTTP request headers that might not be exploitable in relation to reflected XSS.
- Any out-of-band routes via which an attacker can deliver data into the application. The routes that exist depend entirely on the functionality implemented by the application: a webmail application will process data received in emails; an application displaying a Twitter feed might process data contained in third-party tweets; and a news aggregator will include data originating on other web sites.

To comprehensively identify links between entry and exit points would involve testing each permutation separately, submitting a specific value into the entry point, navigating directly to the exit point, and determining whether the value appears there. 
However, this approach is not practical in an application with more than a few pages.

When you have identified links between entry and exit points in the application's processing, each link needs to be specifically tested to detect if a stored XSS vulnerability is present. 

This involves determining the context within the response where the stored data appears and testing suitable candidate XSS payloads that are applicable to that context.


