
**==Authorization is the process of determining exactly what an authenticated party can do==**. 

==**You typically implement authorization using access controls**, which are the tools and systems you use to deny or allow access==.

In this chapter, you’ll learn about access controls in more detail and look at some ways of implementing them.


# What Are Access Controls?

When you lock or unlock the doors of your house, you’re using a form of physical access control, based on your keys.
Your keys are something you have, as discussed in Chapter 2; in this case, they function as methods of both authentication and authorization.

You’ll probably want to use access controls to carry out four basic tasks: ==allowing access==, ==denying access==, ==limiting access==, and ==revoking access==.

**Allowing access** is giving a party access to a given resource.

**Denying access** is the [opposite](https://translate.google.com/?sl=en&tl=ar&text=opposite&op=translate) of granting access.
==**Many access control systems are set to deny by default.**==

**Limiting access** 
is allowing only some degree of access to your resources.
Limited access when you’re using applications that may be exposed to attack prone environments, like web browsers used on the internet. 
One way to limit access is by running sensitive applications in sandboxes, which are isolated environments containing a set of resources for a given purpose.
![[Pasted image 20250204110925.png]]

**Revoking access** is taking access away from a party after you’ve granted it.
If you were, for instance, to fire an employee, you’d want to revoke any accesses they might have, including access to their email account, your virtual private network (`VPN`), and your facility.



# Implementing Access Controls
The two main methods of implementing access controls are with access control lists and capabilities.


## Access Control Lists
Access control lists (`ACLs`), often pronounced “`ackles`,” are lists containing information about what kind of access certain parties are allowed to have to a given system.

Alice is allowed access to the resource, while Bob is specifically denied access.
![[Pasted image 20250204111609.png]]
A simple access control list


### File System ACLs
The ACLs in most file systems will have three types of permissions ==read==, ==write==, and ==execute==.



### Network ACLs
If you look at the variety of activities that take place on networks, both private and public, you’ll notice ACLs regulating the activity. 

In network ACLs, you typically filter access based on identifiers used for network transactions, such as Internet Protocol (IP) addresses, Media Access Control addresses, and ports.

You can see such ACLs at work in network infrastructure such as routers, switches, and firewall devices, as well as in software firewalls, websites.

Permissions in network ACLs tend to be binary in nature; rather than read, write, and execute, they generally either allow or deny some activity.

Instead of users, network ACLs typically grant permissions to traffic.

**Media Access Control address filtering** is one of the simplest forms of network-oriented ACLs.

When you combine several attributes, you begin to arrive at a more secure technique.
==For example, it’s common to use both an IP address and a port, a combination typically called a **socket**==.
Using sockets, you can allow or deny network traffic from one or more IP addresses with one or more applications on your network in a workable fashion.


### Weaknesses of ACL Systems
==Systems that use ACLs to manage permissions are vulnerable to a type of attack called the== ==**confused deputy (نائب) problem**==.

This problem occurs when the software with access to a resource (the deputy) ==has a greater level of permission to access the resource than the user who is controlling the software==.
If you can trick the software into misusing its greater level of authority, you can potentially carry out an attack.

**==Two of the more common attacks that exploit the confused deputy problem are cross-site request forgery (CSRF) and clickjacking==**.


#### Cross-site request forgery (CSRF) 
In this example, the attacker has embedded a request to transfer funds from an account at `BankCo` to the attacker’s offshore account. 
As the `BankCo` server sees the request as coming from an authenticated and authorized user, it proceeds with the transfer. 
In this case, the confused deputy is the bank server.
![[Pasted image 20250204113717.png]]
An example of a CSRF attack


#### clickjacking
Clickjacking, also known as ==user interface redressing==, is a particularly sneaky and effective client-side attack that takes advantage of some of the page rendering features that are available in newer web browsers. 

To carry out a clickjacking attack, the attacker must legitimately control or have taken control of some portion of a website.

The attacker constructs or modifies the site by placing an invisible layer over something the client would normally click. 

This causes the client to execute a command that’s different than the one they think they’re performing.

You can use clickjacking to trick the client into making purchases, changing permissions in their applications or operating systems, or performing other unwanted activities.




## Capabilities
Whereas ACLs define permissions based on a given resource, an identity, and a set of permissions, all generally held in a file of some sort, you can also define permissions based on a user’s token, or key, otherwise known as a **capability**.

In capability-based systems, the right to access a resource is based entirely on possession of the token, rather than who possesses it.

==If you were to give your badge to someone else, he would be able to use it to access the building with whatever set of permissions you have==.

==**If you were to use capabilities instead of ACLs to manage permissions, you could protect against confused deputy attack**==.





# Access Control Models
**==An access control model is a way of determining who should be allowed access to what resources==**.

The most common ones, covered here, include ==discretionary access control==, ==mandatory access control==, ==rule-based access control==, ==role-based access control==, ==attribute-based access control==, and ==multilevel access control==.

## Discretionary Access Control
In the discretionary access control (`DAC`) model, the owner of the resource determines who gets access to it and exactly what level of access they can have.


## Mandatory Access Control
In the mandatory access control (MAC) model, the owner of the resource doesn’t get to decide who gets to access it.
Instead, a separate group or individual has the authority to set access to resources.

**THE PRINCIPLE OF LEAST PRIVILEGE**
The principle of least privilege dictates that you should give a party **only** the bare **minimum** level of access it needs to perform its functionality.


## Rule-Based Access Control
Rule-based access control allows access according to a set of rules defined by the system administrator. 

**==If the rule is matched, access to the resource will be granted or denied accordingly==**.

A good example of rule-based access control is an ACL used by a router.
You might see a rule specifying that traffic coming from source A to destination B on port C is allowed.


## Role-Based Access Control
The role-based (على أساس الدور) access control (`RBAC`) model allows access based on the role of the individual being granted access.

For example, if you have an employee whose only role is to enter data into an application, `RBAC` would mandate that you allow the employee access to only that application.


## Attribute-Based Access Control
Attribute-based access control (ABAC) is based on the specific attributes of a person, resource, or environment. 

You can often find it implemented on infrastructure systems, such as those in network or telecommunications environments.

Subject attributes belong to an individual. 
We could choose any number of attributes, such as height in the classic “`you must be this tall to ride`”

Another common example of subject attributes are CAPTCHAs, or “`completely automated public Turing tests to tell humans and computers apart`”

CAPTCHAs control access based on whether the party on the other end can pass a test that is (in theory) too difficult for a machine to complete.
![[Pasted image 20250204115848.png]]


**Resource attributes** belong to a resource, such as an operating system or application. 
As example some software runs only on a particular operating system, and some websites work only with certain browsers.

You can use **environmental attributes** to enable access controls based on environmental conditions. 
People commonly use time to control access to physical and logical resources.
Access controls on buildings often allow access only during business hours.



# Multilevel Access Control
Multilevel access control models combine several of the access control models.


## The Bell–LaPadula Model 
The Bell–LaPadula model implements a combination of discretionary and mandatory access controls (`DAC` and `MAC`) and is primarily concerned with the confidentiality of the resource in question in other words, making sure unauthorized people can’t read it.

In short, this means that when you’re handling classified information, you can’t read any higher than your clearance level, and you can’t write classified data down to any lower level.

![[Pasted image 20250204130207.png]]
The Bell–LaPadula model


## The Biba Model
The Biba model of access control is primarily concerned with protecting the integrity of data, even at the [expense of confidentiality](https://translate.google.com/?sl=en&tl=ar&text=expense%20of%20confidentiality&op=translate).

==That means it’s more important to keep people from **altering** the data than from **viewing** it==.

This means that assets that are of high integrity (meaning they shouldn’t be altered) and assets that are of low integrity are kept strictly apart.
![[Pasted image 20250204130636.png]]
The Biba model



# Summery
Authorization is a key step in the process of allowing parties to access resources in other words, the identification, authentication, and authorization process.

You implement authorization by using access controls.

Typically, you use one of two access control methods: access control lists or capabilities.


