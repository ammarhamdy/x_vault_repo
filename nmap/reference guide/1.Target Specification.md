
https://nmap.org/book/man-target-specification.html
---

The simplest case is to specify a target IP address or hostname for scanning.


When a hostname is given as a target, it is _resolved_ via the Domain Name System (DNS) to determine the IP address to scan. 

If the name resolves to more than one IP address, only the first one will be scanned. 

To make Nmap scan all the resolved addresses instead of only the first one, use the `--resolve-all` option.




## Nmap supports CIDR-style addressing

Sometimes you wish to scan a whole network of adjacent hosts. 
For this, Nmap supports CIDR-style addressing.

For example, `192.168.10.0/24` would scan the 256 hosts between 
+ 192.168.10.0 (binary: `11000000 10101000 00001010 00000000`) and 
+ 192.168.10.255 (binary: `11000000 10101000 00001010 11111111`)

The smallest allowed value is `/0`, which targets the whole Internet.

The largest value for IPv4 is `/32`, which scans just the named host or IP address because all address bits are fixed.

The largest value for IPv6 is `/128`, which does the same thing.




## Nmap supports octet range addressing

Rather than specify a normal IP address, you can specify a comma-separated list of numbers or ranges for each octet. 
For example:
```
192.168.0-255.1-254
```
 + will skip all addresses in the range that end in .0 or .255 
```
192.168.3-5,7.1
```
+ will scan the four addresses 192.168.**3**.1, 192.168.**4**.1, 192.168.**5**.1, and 192.168.**7**.1




## Nmap accepts multiple host

Nmap accepts multiple host specifications on the command line, and they don't need to be the same type. 

The command:
```sh
nmap scanme.nmap.org 192.168.0.0/8 10.0.0,1,3-7.-
```
does what you would expect.




## Reads target from file

Simply generate the list of hosts to scan and pass that filename to Nmap as an argument to the `-iL` option.

```sh
nmap -iL <inputfilename>
```

Entries can be in any of the formats accepted by Nmap on the command line (IP address, hostname, CIDR, IPv6, or octet ranges).

Each entry must be separated by one or more spaces, tabs, or newlines.

The input file may contain comments that start with `#` and extend to the end of the line.

You can specify a hyphen (`-`) as the filename if you want Nmap to read hosts from standard input rather than an actual file.
```sh
nmap -iL -
```




## Choose random targets

```sh
nmap -iR <num hosts>
```

For Internet-wide surveys and other research, you may want to choose targets at random. 

The _`<num hosts>`_ argument tells Nmap how many IPs to generate. 

Undesirable IPs such as those in certain private, multicast, or un-allocated address ranges are automatically skipped.

The argument `0` can be specified for a never-ending scan.

try this command to locate random web servers for browsing.
```sh
nmap -Pn -sS -p 80 -iR 0 --open
```
`-Pn`	-> Skip ping — treat all hosts as up, even if they don't respond to ICMP (ping).
`-sS`	-> Use TCP SYN scan (stealthy scan). Sends SYN packets and analyzes responses.
`-p 80`	-> Only scan port 80 (HTTP).
`-iR 0`	-> Choose random IPs to scan. `0` means "==forever==" it’ll keep going until you stop it.
`--open` -> Only show hosts with the port open (ignores closed/filtered ones).




## Exclude hosts/networks

```sh
nmap --exclude <host1>[,<host2>[,...]]
``` 

Specifies a comma-separated list of targets to be excluded from the scan even if they are part of the overall network range you specify.




## Exclude list from file

```sh
nmap --excludefile <exclude_file> 
```

This offers the same functionality as the `--exclude` option, except that the excluded targets are provided in a newline-, space-, or tab-delimited _`<exclude_file>`_ rather than on the command line.




## No DNS resolution

```sh
nmap -n 
```

Tells Nmap to _never_ do reverse DNS resolution on the active IP addresses it finds. 

Since DNS can be slow even with `Nmap`'s built-in parallel stub resolver, this option can slash scanning times.




## DNS resolution for all targets

```sh
nmap -R
```

Tells Nmap to _always_ do reverse DNS resolution on the target IP addresses. 

Normally reverse DNS is only performed against responsive (online) hosts.




##  Scan each resolved address

```sh
nmap --resolve-all
```

If a hostname target resolves to more than one address, scan all of them. 

The default behavior is to only scan the first resolved address. 

Regardless, only addresses in the appropriate address family will be scanned: IPv4 by default, IPv6 with `-6`.



## Scan each address only once

```sh
nmap --unique
```

Scan each IP address only once. 

The default behavior is to scan each address as many times as it is specified in the target list, such as when network ranges overlap or different host-names resolve to the same address.



## Use system DNS resolver

```sh
nmap --system-dns
```

By default, Nmap reverse-resolves IP addresses by sending queries directly to the name servers configured on your host and then listening for responses. 

Many requests (often dozens(العشرات)) are performed in parallel to improve performance.

Specify this option to use your system resolver instead (one IP at a time via the `getnameinfo` call). 

==This is slower and rarely useful unless you find a bug in the Nmap parallel resolver== (please let us know if you do). 

The system resolver is always used for forward lookups (getting an IP address from a hostname).



## Servers to use for reverse DNS queries

```sh
nmap --dns-servers <server1>[,<server2>[,...]]
```

By default, Nmap determines your DNS servers (for rDNS resolution) from your `resolv.conf` file (Unix) or the Registry (Win32). 

Alternatively, you may use this option to specify alternate servers. 

This option is not honored (مُكرّم) if you are using `--system-dns`. 

==Using multiple DNS servers is often **faster**==, especially if you choose authoritative servers for your target IP space. 

This option can also improve stealth, as your requests can be bounced off just about any recursive DNS server on the Internet.

**Run this see details about the uplink DNS servers currently in use**
```sh
resolvectl status
```
It's part of the `systemd-resolved` service, which handles DNS name resolution for your system.
- Shows the **default DNS servers** your system is using.
- Includes **fallback servers** (in case the main ones fail).
- May list **DNSSEC** status (a security feature for DNS).


