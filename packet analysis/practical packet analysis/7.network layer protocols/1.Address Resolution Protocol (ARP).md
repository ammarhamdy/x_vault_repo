
Both logical and physical addresses are used for communication on a network. 
**Logical addresses** allow for communication among multiple networks and indirectly connected devices. 
**Physical addresses** facilitate communication on a single network segment for devices that are directly connected to each other with a switch.

**Content Addressable Memory (CAM) table:**
lists the MAC addresses of all devices plugged into each of its ports. 
When the switch receives traffic destined for a particular MAC address, it uses this table to know which port to send the traffic through.

**The ARP resolution process:**
The resolution process that TCP/IP networking (with IPv4) uses to resolve an IP address to a MAC address is called the Address Resolution Protocol (ARP), which is defined in `RFC 826`.
The ARP resolution process uses only two packets: an ARP request and an ARP response

```
An RFC, or Request for Comments, is a technical publication from the Internet Engineering Task Force (IETF) and Internet Society (ISOC) and is the mechanism used to define the implementation standards for protocols. 
You can search for RFC documentation at the RFC Editor home page, http://www.rfc-editor.org/.
```

The transmitting computer sends out an ARP request that basically says, 
“
	Howdy, everybody. 
	My IP address is `192.168.0.101`, and my MAC address is `f2:f2:f2:f2:f2:f2`. 
	I need to send something to whoever has the IP address `192.168.0.1`, but I don’t know the hardware address. 
	Will whoever has this IP address please respond with your MAC address?
”
The device that does have the address sends an ARP reply with an answer such as 
“
	Hey, transmitting device, I’m the one you’re looking for with the
	IP address 192.168.0.1. My MAC address is `02:f2:02:f2:02:f2`.
”


# ARP Packet Structure

![[Pasted image 20250125181432.png]]

**Hardware Type** 
	The layer 2 type used—in most cases, this is Ethernet (type 1)
**Protocol Type** 
	The higher-layer protocol for which the ARP request is being used
**Hardware Address Length** 
	The length (in octets/bytes) of the hardware address in use (6 for Ethernet)
**Protocol Address Length** 
	The length (in octets/bytes) of the logical address of the specified protocol type
**Operation** 
	The function of the ARP packet: ==either 1 for a request or 2 for a reply==
**Sender Hardware Address** 
	The hardware address of the sender
**Sender Protocol Address** 
	The sender’s upper-layer protocol address 
**Target Hardware Address** 
	The [intended](https://translate.google.com/?sl=en&tl=ar&text=intended&op=translate)  (مقصود) receiver’s hardware address (all zeroes in ARP requests)
**Target Protocol Address** 
	The intended receiver’s upper-layer protocol address


# ARP request:

![[Pasted image 20250125184313.png]]


![[Pasted image 20250125184812.png]]

We can confirm that this packet is a true broadcast packet by examining the Ethernet
header in Wireshark’s Packet Details pane. 
The packet’s **==destination address==** is `ff:ff:ff:ff:ff:ff`

The source address of this packet in the Ethernet header is listed as our MAC address.

Given this structure, we can discern that this is indeed an ARP request on an Ethernet network using IPv4.

The sender’s IP address (`192.168.0.114`) and MAC address (`00:16:ce:6e:8b:24`) are listed as is the IP address of the target (`192.168.0.1`)

The MAC address of the target the information we are trying to get—is unknown, so the target MAC is listed as `00:00:00:00:00:00`


# Packet 2: ARP Response



In the response to the initial request the Ethernet header now has a destination address of the source MAC address from the first packet. 
The ARP header looks similar to that of the ARP request, with a few changes:
+ The packet’s operation code (opcode) is now `0x0002` , indicating a reply rather than a request.
+ The addressing information is reversed—the sender MAC address and IP address are now the target MAC address and IP address.
+ Most important, all the information is present, meaning we now have the MAC address (`00:13:46:0b:22:ba`) of our host at `192.168.0.1`.

![[Pasted image 20250125202328.png]]


# [Gratuitous](https://translate.google.com/?sl=en&tl=ar&text=Gratuitous&op=translate) (لا مبرر له) ARP

Where I come from, when something is done “[gratuitously](https://translate.google.com/?sl=en&tl=ar&text=gratuitously&op=translate), (بلا مقابل)” the word usually carries a negative connotation. 
A gratuitous ARP, however, is a good thing.

![[Screenshot from 2025-01-25 20-29-02.png]]

In many cases, a device’s IP address can change. 
When this happens, the IP-to-MAC address mappings that hosts on the network have in their
caches will be invalid. 
To prevent this from causing communication errors, a gratuitous ARP packet is transmitted on the network to **==force any device that receives it to update its cache with the new IP-to-MAC address mapping.==**

The ARP header looks like an ARP request, except that the sender IP address and the target IP address are the same. 
When received by other hosts on the network, this packet will cause them to update their ARP tables with the new IP-to-MAC address association.

**==Also, some operating systems will perform a gratuitous ARP on startup.==**

