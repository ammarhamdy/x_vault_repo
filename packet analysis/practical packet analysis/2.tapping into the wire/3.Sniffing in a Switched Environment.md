
Switches allow full-duplex communication, meaning that machines can send and receive data simultaneously.

When you connect a sniffer to a port on a switch, you can see **only** broadcast traffic and the traffic transmitted and received by the device the sniffer is installed on

The visibility window on a switched network is limited to the port you are plugged into.

There are four primary ways to capture this traffic: 
+ port mirroring, 
+ hubbing out, 
+ using a tap, 
+ and ARP cache poisoning.


# Port Mirroring

Port mirroring, or port spanning, is perhaps the easiest way to capture the traffic from a target device on a switched network. 

In this type of setup, you must have access to the command line or web management interface of the switch on which the target computer is located. 

Also, the switch must support port mirroring and have an empty port into which you can plug your sniffer.

**==To enable port mirroring, you issue a command that forces the switch to copy all traffic on one port to another port.==**

How you set up port mirroring depends on the manufacturer of your switch.
For most enterprise switches, you’ll need to log in to a command line interface and configure port mirroring using a specific command.


| Manufacturer | Command                                                                              |
| ------------ | ------------------------------------------------------------------------------------ |
| Cisco        | set span `<source port> <destination port>`                                          |
| Enterasys    | set port mirroring create `<source port> <destination port>`                         |
| Nortel       | port-mirroring mode mirror-port  `<source port>`   monitor-port `<destination port>` |

Port mirroring can provide inconsistent results and cause data loss that can be hard to track down.


---
# Hubbing Out

Another way to capture the traffic through a target device on a switched network is by hubbing out. 

With this technique, you place the target device and your analyzer system on the same network segment by plugging them both directly into a hub. 

Many people think of hubbing out as “cheating,” but it’s really a valid solution when you can’t perform port mirroring but still have physical access to the switch the target device is plugged into.




---
# Using a Tap

A network tap is a hardware device that you can place between two points on your cabling system to capture the packets between those two points. 

As with hubbing out, you place a piece of hardware on the network that allows you to capture the packets you need. 

**==The difference is that rather than using a hub, you use a specialized piece of hardware designed for network analysis.==**



---
# ARP Cache Poisoning

## The ARP Process
All devices on a network communicate with each other on layer 3 using IP addresses. 

Because switches operate on layer 2 of the OSI model, they are cognizant of only layer 2 MAC addresses, so devices must be able to include this information in packets they construct.

==**When a MAC address is not known, it must be obtained using the known layer 3 IP addresses so traffic can be forwarded to the appropriate device**==.
This translation process is done through the layer 2 protocol ARP.

**The ARP process**, for computers connected to Ethernet networks, begins when one computer wishes to communicate with another. 
The transmitting computer first checks its ARP cache to see whether it already has the MAC address associated with the IP address of the destination computer.
If it does not, it sends an ARP request to the data link layer broadcast address `ff:ff:ff:ff:ff:ff`.

This broadcast packet is received by **==every==** computer on that particular Ethernet segment.
Devices without the destination computer’s IP address simply discard this ARP request. 
The destination machine replies to the packet with its MAC address via an ARP reply.

At this point, the original transmitting computer now has the data link layer addressing information it needs to communicate with the remote computer, and it stores that information in its ARP cache for fast retrieval.


## How ARP Cache Poisoning Works

**==ARP cache poisoning==**, sometimes called **==ARP spoofing==**, is an advanced form of tapping into the wire on a switched network.

It works by sending ARP messages to an Ethernet switch or router with fake MAC (layer 2) addresses in order to intercept the traffic of another computer.
![[Pasted image 20250119140832.png]]


### Using Cain & Abel

When attempting to poison the ARP cache, the first step is to acquire the necessary tools and collect some information.

For our demonstration, we’ll use the popular security tool Cain & Abel from `oxid.it`.