
# How Packet Sniffers Work

The packet-sniffing process involves a cooperative effort between software and hardware.
This process can be broken down into three steps:
+ **Collection**:
	+ First, the packet sniffer collects raw binary data from the wire. 
	+ Typically this is done by switching the selected network interface into **==promiscuous mode==**. 
	+ In this mode, the network card can listen to all traffic on a network segment, not only the traffic that is addressed to it.
+ **Conversion**:
	+ Next, the captured binary data is converted into a read-able form. 
	+ This is as far as most advanced command line packet sniffers can go. 
	+ At this point, the network data can be interpreted only on a very basic level, leaving the majority of the analysis to the end user.
+ **Analysis**:
	+ Finally, the packet sniffer conducts an analysis of the captured and converted data.
	+ The sniffer verifies the protocol of the captured net-work data based on the information extracted and begins its analysis of that protocol’s specific features.



---
# How Computers Communicate

## Protocols

Modern networks are made up of a variety of systems running on many different platforms. 
To communicate between systems, we use a set of common languages called protocols.
A logical grouping of protocols that work together is called a **==protocol stack==**.


## Open Systems Interconnections (OSI) model

Protocols are separated according to their functions based on the industry-standard OSI reference model.

![[Pasted image 20250119112932.png]]


**Application layer (layer 7)** 
The topmost layer of the OSI model provides a means for users to access network resources. This is the only layer typically seen by end users, as it provides the interface that is the base for all of their network activities. 

**Presentation layer (layer 6)** 
This layer transforms the data it receives into a format that can be read by the application layer. 
The data encoding and decoding done here depends on the application layer protocol that is sending or receiving the data. 
The presentation layer also handles several forms of encryption and decryption used to secure data. 

**Session layer (layer 5)** 
This layer manages the dialogue, or session, between two computers.
It establishes, manages, and terminates this connection among all communicating devices.
The session layer is also ==responsible for establishing whether a connection is duplex== (two-way) or half-duplex (one-way) and for gracefully closing a connection between hosts rather than dropping it abruptly. 

**Transport layer (layer 4)** 
The primary purpose of the transport layer is to ==provide reliable data transport services to lower layers==. 
Through ==**flow control**==, ==**segmentation**/**de-segmentation**==, and ==**error control**==, the transport layer makes sure data gets from point to point error-free.
The transport layer utilizes both connection-oriented and connection-less protocols. 
==**Certain firewalls and proxy servers operate at this layer**==.

**Network layer (layer 3)** 
**==This layer, one of the most complex of the OSI layers, is responsible for routing data between physical networks==**. 
It sees to the logical addressing of network hosts (for example, through an IP address). 
It also handles splitting data streams into smaller fragments and, in some cases, error detection. 
Routers operate at this layer. 

**Data link layer (layer 2)** 
This layer provides a means of transporting data across a physical network.
**==Its primary purpose is to provide an addressing scheme that can be used to identify physical devices (for example, MAC addresses)==**. 
Bridges and switches are physical devices that operate at the data link layer. 

**Physical layer (layer 1)** 
The layer at the bottom of the OSI model is the **==physical medium==** through which network data is transferred. 
**==This layer defines the physical and electrical nature of all hardware used, including voltages, hubs, network adapters, repeaters, and cabling specifications==**. 
The physical layer establishes and terminates connections, provides a means of sharing communication resources, and converts signals from digital to analog and vice versa.

_Please Do Not Throw Sausage Pizza Away._

![[Pasted image 20250119114711.png]]

Although the OSI model is **==no more than==** a recommended standard, you should know it by heart as it provides a useful vocabulary for thinking about and describing network problems.

==Protocols at different levels may have features with similar goals, but they will function a bit **differently**==.


## Data Encapsulation

Each layer in the stack is responsible for adding a header or footer—extra bits of information that allow the layers to communicate—to the data being transferred.

The encapsulation process creates a protocol data unit (PDU), which includes the data being sent and all header or footer information added to it.

![[Pasted image 20250119115640.png]]


## Protocol rides on another protocol
We often say that one protocol “sits on” or “rides on” another protocol because of the top-down design of the OSI model. 
An application protocol such as HTTP provides a particular service and relies on TCP to ensure reliable delivery of its service. 
Both of those services rely on the IP protocol at the network level to address and deliver their data. 
Therefore, ==**HTTP sits on TCP, which sits on IP**==.


## Network Hardware

### Hubs 
A hub is generally a box with multiple RJ-45 ports. 
Hubs range from very small 4-port devices to larger 48-port devices designed for rack mounting in a corporate environment.

Because hubs can generate a lot of unnecessary network traffic and are capable of operating only in half-duplex mode (they cannot send and receive data at the same time)

A hub is no more than a **==repeating==** device that operates on the physical layer of the OSI model.

It takes packets sent from one port and transmits (repeats) them to **==every==** other port on the device, and it’s up to the Packet Analysis and Network Basics 11 receiving device to accept or reject each packet.

The best alternatives to hubs in production and high-density networks are switches, which are ==full-duplex== devices that can send and receive data synchronously.


### Switches
Like a hub, a switch is designed to repeat packets. However, unlike a hub, rather than broadcasting data to every port, a switch sends data to only the computer for which the data is intended.

**Managed switches** provide several features that can be useful in network management, including the ability to enable or disable specific ports, view port statistics, make configuration changes, and remotely reboot.

Switches must be able to uniquely identify devices based on their MAC addresses, which means that they must operate on the data link layer of the OSI model.

==When a packet is transmitted, the switch reads the layer 2 header information in the packet and, using the CAM table as reference, determines to which port(s) to send the packet.==


### Routers
A router is an advanced network device with a much higher level of functionality than a switch or a hub.
A router can take many shapes and forms, but most devices have several LED indicator lights on the front and a few network ports on the back, depending on the size of the network.

Routers operate at **layer 3** of the OSI model, ==where they are responsible for forwarding packets between two or more networks==. 

Routers commonly use layer 3 addresses (such as IP addresses) to uniquely identify devices on a network.




---
# Traffic Classifications

Network traffic can be classified as one of three types: ==broadcast==, ==multicast==, and ==unicast==.

## Broadcast Traffic

A broadcast packet is a packet that’s sent to all ports on a network segment, regardless of whether a given port is a hub or switch.

There are layer 2 and layer 3 forms of broadcast traffic.

On layer 2, the MAC address `ff:ff:ff:ff:ff:ff` is the reserved broadcast address, and any traffic sent to this address is broadcast to the entire network segment.

Layer 3 also has a specific broadcast address, but it varies based on the network address range in use.
For example, if your computer has an address of `192.168.0.20` and a `255.255.255.0` subnet mask, then `192.168.0.255` is the broadcast address.


## Multicast Traffic
Multicast is a means of transmitting a packet from a single source to ==multiple== destinations simultaneously. 

==The goal of multicasting is to use as little bandwidth as possible==. 

The optimization of this traffic lies in that a stream of data is replicated fewer times along its path to its destination. 

The exact handling of multicast traffic is highly dependent on its implementation in individual protocols.

The primary method of implementing multicast traffic is via an addressing scheme that joins the packet recipients to a multicast group.

IP devotes an entire range of addresses to multicast. 
If you see an IP address in the `224.0.0.0` to `239.255.255.255` range, it is most likely handling multicast traffic because these ranges are reserved for that purpose.


## Unicast Traffic

A unicast packet is transmitted from one computer directly to another.