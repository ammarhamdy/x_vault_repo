

## Authentication and acount information: 
+ User account information is stored in the `/etc/passwd` file and user authentication information (password data) is stored in the `/etc/shadow` file. 
+ Creating a new user can be accomplished by manually adding a new line to each of these files, but that is generally not the recommended technique.


## To add user:
+ Before you begin creating users for your system, you should verify or establish practical values that are used by default with the `useradd` command. 
+ These settings can be found in the configuration files that are used by the `useradd` command.



---
# User Configuration Files


## Use `useradd -d` to show default values:
+ The `-D` option to the `useradd` command allows you to view or change some of the default values used by the `useradd` command. 
+ The values shown by `useradd -D` can also be viewed or updated by manipulating the `/etc/default/useradd` file:
```bash
root@localhost:~# useradd -D 
GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/bash
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes
```
+ The following describes each of these values:
	+ **Group**
	+ **Home**
	+ **Inactive**
	+ **Expire**
	+ **Shell**
	+ **Skeleton Directory**
	+ **Create Mail Spool**



### Group:
```
GROUP=100
```
+ In distributions not using UPG, this is the default primary group for a new user, if one is not specified with the `useradd` command. This is usually the `users` group with a GID of 100.
+ This setting affects the primary group ID field of the `/etc/passwd` file highlighted below:
> bob:x:600:==600==:bob:/home/bob:/bin/bash
+ The `-g` option to the `useradd` command allows you to use a different primary group than the default when creating a new user account.


### Home:
```
HOME=/home
```
+ The `/home` directory is the default base directory under which the user's new home directory is created. This means that a user with an account name of `bob` would have a home directory of `/home/bob`.
+ This setting affects the home directory field of the `/etc/passwd` file highlighted below:
> bob:x:600:600:bob:==/home/bob==:/bin/bash
+ The `-b` option to the `useradd` command allows you to use a different base directory group than the default when creating a new user account.



### Inactive:
```
INACTIVE=-1
```
+ This value represents the number of days after the password expires that the account is disabled.
+ A value of `-1` means this feature is not enabled by default and no "inactive" value is provided for new accounts by default.
+ This setting affects the inactive field of the `/etc/shadow` file highlighted below:
> bob:pw:15020:5:30:7:==60==:15050:



### Expire:
```
EXPIRE=
```
+ By default, there is no value set for the expiration date. Usually, an expiration date is set on an individual account, not all accounts by default.
+ For example, if you had a contractor that was hired to work until the end of the day on November 1, 2019, then you could ensure that they would be unable to log in after that date by using the `EXPIRE` field.
+ This setting affects the expire field of the `/etc/shadow` file highlighted below:
> bob:pw:15020:5:30:7:60:==15050==:
+ The `-e` option to the `useradd` command allows you to use a different `EXPIRE` value than the default when creating a new user account.


### Shell:
```
SHELL=/bin/bash
```
+ The `SHELL` setting indicates the default shell for a user when they log in to the system.
+ This setting affects the shell field of the `/etc/passwd` file highlighted below:
> bob:x:600:600:bob:/home/bob:==/bin/bash==
+ The `-s` option to the `useradd` command allows you to use a different login shell than the default when creating a new user account.


### Skeleton Directory:
```
SKEL=/etc/skel
```
+ The `SKEL` value determines which skeleton directory has its contents copied into the new user’s home directory.
+ The contents of this directory are copied into the new user's home directory, and the new user is given ownership of the new files.
+ This setting provides administrators with an easy way to populate a new user account with key configuration files.
+ The `-k` option to the `useradd` command allows you to use a different `SKEL` directory than the default when creating a new user account.


### Create Mail Spool:
```
CREATE_MAIL_SPOOL=yes
```
+ A mail spool is a file where incoming email is placed.
+ Currently, the value for creating a mail spool is `yes`, which means that users by default are configured with the ability to receive and store local mail. 
+ If you are not planning on using local mail, then this value could be changed to `no`.




## Change some values:
+ To modify one of the `useradd` default values, the `/etc/default/useradd` file could be edited with a text editor. Another (safer) technique is to use the `useradd -D` command. 
+ For example, if you wanted to allow users to have expired passwords that they could still log in with for up to thirty days, then you could execute:
```
root@localhost:~# useradd -D -f 30
root@localhost:~# useradd -D
GROUP=100
HOME=/home
INACTIVE=30
EXPIRE=
SHELL=/bin/bash
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes
```




---
# User Configuration Files


The `/etc/login.defs` file also contains values that are applied by default to new users you create with the `useradd` command. Unlike the `/etc/default/useradd` file, the `/etc/login.defs` file is usually edited directly by the administrator to alter its values.

This file contains many comments and blank lines, so to only view lines that are not comments or blank lines (the real configuration settings), then you can use the following `grep` command:
```
root@localhost:~#  grep -Ev '^#|^$' /etc/login.defs
MAIL_DIR	/var/mail/spool
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_MIN_LEN	5
PASS_WARN_AGE	7
UID_MIN			  500
UID_MAX			60000
GID_MIN			  500
GID_MAX			60000
CREATE_HOME	yes
UMASK           077
USERGROUPS_ENAB yes
ENCRYPT_METHOD SHA512
MD5_CRYPT_ENAB no
```
+ The above example represents a typical CentOS 6 distribution `/etc/login.defs` file with its values. 
+ The following describes each of these values:


### **Mail Directory**:  
```
MAIL_DIR		/var/mail/spool
```
+ The directory in which the user's mail spool file is created.


###  **Password Maximum Days**:
```
  PASS_MAX_DAYS	99999
```
+ This setting determines the maximum number of days that a user can continue to use the same password. 
+ Since it defaults to `99999` days (over 200 years) it effectively means users never have to change their password.
+ Organizations with effective policies for maintaining secure passwords typically change this value to `60` or `30` days.
+ This setting affects the default setting of the `/etc/shadow` file highlighted below:
> bob:pw:15020:5:==30==:7:60:15050:



### Password Minimum Days:
```
PASS_MIN_DAYS	0
```
+ With this set to a default value of zero, the shortest time that a user is required to keep a password is zero days, which means that they can immediately change a password that they have just set.
+ If the `PASS_MIN_DAYS` value was set to three days, then after setting a new password, the user would have to wait three days before they could change it again.
+ This setting affects the default setting of the /etc/shadow file highlighted below:
> bob:pw:15020:==3==:30:7:60:15050:


### Password Minimum Length:
```
PASS_MIN_LEN	5
```
+ This indicates the minimum number of characters that a password must contain.


### Password Warning:
```
PASS_WARN_AGE	7
```
+ This is the default for the warning field. 
+ As a user approaches the maximum number of days that they can use their password, the system checks to see if it is time to start warning the user about changing their password at login.
+ This setting affects the default setting of the `/etc/shadow` file highlighted below:
> bob:pw:15020:3:30:==7==:60:15050:


### UID Minimum:
```
UID_MIN			  500
```
+ The UID_MIN determines the first UID that is assigned to an ordinary user.
+ Any UID less than this value would either be for a system account or the root account.


### UID Maximum:
```
UID_MAX			60000
```
+ A UID technically could have a value of over four billion. For maximum compatibility, it's recommended to leave it at its default value of 60000.


### GID Minimum:
```
GID_MIN			  500
```
+ The GID_MIN determines the first GID that is assigned to an ordinary group. 
+ Any group with a GID less than this value would either be a system group or the root group.


### GID Maximum:
```
GID_MAX			60000
```
+ A GID, like a UID, could have a value of over four billion. 
+ Whatever value you use for your UID_MAX, should be used for GID_MAX to support UPG.


### Home Directory:
```
CREATE_HOME	yes
```
+ The value of this determines whether or not a new directory is created for the user when their account is created.


### Umask:
```
UMASK           077
```
+ UMASK works at the time the user home directory is being created; it determines what default permissions are placed on this directory.
+ Using the default value of 077 for UMASK means that only the user owner has any kind of permission to access their directory.


### UPG:
```
USERGROUPS_ENAB yes
```
+ In distributions that feature a private group for each user, as this CentOS example shows, the USERGROUPS_ENAB will have a value of yes.
+ If UPG is not used in the distribution, then this will have a value of no.


### Encryption:
```
ENCRYPT_METHOD SHA512
```
+ The encryption method that is used to encrypt the users' passwords in the /etc/shadow file. 
+ The ENCRYPT_METHOD setting overrides the MD5_CRYPT_ENAB setting.


### Encryption (Deprecated):
```
MD5_CRYPT_ENAB no
```
+ This deprecated setting originally allowed the administrator to specify using MD5 encryption of passwords instead of the original DES encryption. 
+ It has been superseded by the ENCRYPT_METHOD setting.





----
# Account Considerations