
Successfully deploying a web shell requires more than just exploiting a file upload. Key considerations include:

- **Execution context**: Match the shell to the target’s programming language, server setup, and environment (e.g., PHP compatibility).
    
- **Filepath and location**: Choose writable directories ==where the shell can run effectively==, considering the app’s directory structure, access controls, and common storage paths (e.g., `/uploads`, `/images`, `/var/www/html`).

- **Access controls & authorization**: Check authentication, user roles, and privilege boundaries — vulnerabilities in these areas (e.g., role misuse or privilege escalation) can affect whether and how a web shell can be staged. Sometimes uploading requires authentication even if the uploaded file is later public.

- **Web application firewalls & detection**: WAFs and other security tools can spot common web shells or suspicious command execution attempts; using well-known shells increases detection risk. Endpoint detection may also flag server processes running shell commands and block or alert on them.


# Finding Directory Traversal Vulnerabilities

**Directory traversal vulnerabilities** ==allow attackers to access files or directories outside the intended directory==. 

This weakness can occur when input parameters or file upload functionality aren’t properly validated and sanitized.

To exploit a directory traversal vulnerability, an attacker can craft a
malicious filename that includes the directory traversal sequence `../`
**For example**: `../../../../../etc/password`

## File Integrity Monitoring (FIM)

File Integrity Monitoring (`FIM`) is a **security control** that detects unauthorized or unexpected changes to files, directories, and system configurations. It’s widely used in compliance, intrusion detection, and system hardening.
### Key Points about `FIM`:

- **Core Idea**: It tracks the integrity of files by comparing their current state to a known, trusted baseline.

- **What It Monitors**: Critical system files, configuration files, executables, logs, and sensitive data.

- **How It Works**:
    1. A baseline checksum, hash (like SHA-256), or digital signature of files is recorded.
    2. The system periodically scans or monitors files in real time.
    3. If a file is modified, deleted, or replaced, the system generates an alert.
### Types:
- **Host-based**: Installed on individual servers/endpoints to monitor local files.
- **Network-based**: Monitors file integrity across multiple systems in an enterprise environment.


# Executing Web Shell Commands

After chaining together three separate vulnerabilities, we can now execute commands by navigating to the endpoint you just created and append a bash command to the URL. 

The command’s output should be returned in the browser response.

Navigate to `http://172.16.10.10:8081/webshell/uname%20-a` to identify the operating system we just compromised.

Commonly used URL-encoded characters there: [[URL encoding]]

